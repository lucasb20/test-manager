{% extends "base.html" %}

{% block content %}
<h2>Test Run Summary</h2>
<div class="mb-3">
	<a href="{{ url_for('testrun.previous', testsuite_id=testrun.test_suite_id) }}" class="btn btn-secondary">Back to Previous Test Run</a>
	<a href="{{ url_for('testrun.export', testrun_id=testrun.id) }}" class="btn btn-info">Export CSV</a>
</div>
<p><strong>Total Tests:</strong> {{ data.total_tests }}</p>
<p><strong>Passed Tests:</strong> {{ data.passed_tests }}</p>
<p><strong>Failed Tests:</strong> {{ data.failed_tests }}</p>
<p><strong>Skipped Tests:</strong> {{ data.skipped_tests }}</p>
<p><strong>Total Duration:</strong> {{ data.total_duration }}s ({{ data.total_duration_min}} min)</p>
<p><strong>Percent Passed:</strong> {{ data.percent_passed }}%</p>
<table class="table">
	<thead class="table-dark table-striped table-bordered mt-3">
		<tr>
			<th>Test Case ID</th>
			<th>Result</th>
			<th>Executed By</th>
			<th>Executed At</th>
			<th>Duration</th>
			<th>Notes</th>
			<th>Actions</th>
		</tr>
	</thead>
	{% for result in results %}
	<tr>
		<td><a href="{{ url_for('testcase.detail', testcase_id=result.test_case_id) }}" class="text-primary">{{ result.testcase_code }}</a></td>
		<td class="{% if result.result == 'pass' %}table-success{% elif result.result == 'fail' %}table-danger{% else %}table-warning{% endif %}"
		    >{{ result.result }}</td>
		<td>{{ result.executor }}</td>
		<td>{{ result.executed_at | format_datetime }}</td>
		<td>{{ result.duration }}s</td>
		<td>{{ result.notes }}</td>
		<td>
			<div class="d-flex gap-1">
				<a href="{{ url_for('testrun.edit_result', testresult_id=result.id) }}" class="btn btn-secondary btn-sm">Edit</a>
				<a href="{{ url_for('testrun.report_bug', testresult_id=result.id) }}" class="btn btn-info btn-sm">Report</a>
			</div>
		</td>
	</tr>
	{% endfor %}
</table>
{% endblock %}
